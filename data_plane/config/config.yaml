# Data Plane 配置文件

server:
  host: "0.0.0.0"
  port: 8765
  max_connections: 50
  # 接收缓冲区大小
  recv_buffer_size: 65536
  # 发送缓冲区大小
  send_buffer_size: 65536

auth:
  # JWT 密钥（从环境变量读取）
  jwt_secret: "${JWT_SECRET}"
  jwt_algorithm: "HS256"
  # Token 受众限制（若 Token 含 aud，需匹配该值）
  auth_audience: "data_plane"
  # 拒绝包含该 scope 的 Token（防止 Media Token 误用）
  reject_scope: "media"
  # 连接建立后的鉴权超时（秒）
  auth_timeout_sec: 10
  # 是否启用鉴权（开发模式可关闭）
  enabled: true

ros2:
  # ROS Domain ID
  domain_id: 0
  # 节点名称
  node_name: "ws_data_plane"
  # QoS 设置
  qos:
    # 状态订阅 QoS
    state_reliability: "best_effort"
    state_durability: "volatile"
    # 控制发布 QoS
    control_reliability: "reliable"
    control_durability: "volatile"

watchdog:
  # 超时时间（毫秒）
  timeout_ms: 200
  # 检查间隔（毫秒）
  check_interval_ms: 50

state_publish:
  # 机器人状态推送频率 (Hz)
  robot_state_hz: 30
  # 关节状态推送频率 (Hz)
  joint_state_hz: 100
  # 是否启用状态聚合
  enable_aggregation: true

control_sync:
  # Control Plane 基础地址
  control_plane_url: "http://127.0.0.1:8000"
  # Control Plane 内部接口鉴权 Token (需与 Control Plane 的 VR_INTERNAL_TOKEN 一致)
  internal_token: ""
  # 同步间隔（毫秒）
  sync_interval_ms: 1000
  # 请求超时（毫秒）
  timeout_ms: 5000
  # 是否启用同步
  enabled: true

topics:
  # 订阅话题
  subscribe:
    joint_states: "/joint_states"
    robot_state: "/robot_state"
    arm_state: "/arm_state"
    chassis_state: "/chassis_state"
  # 发布话题
  publish:
    vr_intent: "/vr_control_intent"
    cmd_vel: "/cmd_vel"
    watchdog_heartbeat: "/watchdog/heartbeat"

logging:
  level: "INFO"  # DEBUG, INFO, WARN, ERROR
  # 日志文件（空则只输出到 stdout）
  file: ""
  # 是否输出到 journald
  journald: true
